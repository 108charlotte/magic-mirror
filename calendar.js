(()=>{let t,e=!1,n=!1;async function i(){await gapi.client.init({apiKey:"AIzaSyA9_NUnPURqgh8GtAoox3bD9Xim6qUlO9k",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"]}),e=!0,o()}function o(){e&&n&&(document.getElementById("authorize_button").style.visibility="visible")}async function d(){let t;const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),i=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1);try{const e={calendarId:"primary",showDeleted:!1,singleEvents:!0,maxResults:10,orderBy:"startTime",timeMin:n.toISOString(),timeMax:i.toISOString()};t=await gapi.client.calendar.events.list(e)}catch(t){return void(document.getElementById("event-table").innerText=t.message)}const o=t.result.items;if(!o||0==o.length)return void(document.getElementById("event-table").innerText="No events today.");let d="<table>\n        <thead>\n          <tr>\n            <th>Event</th>\n            <th>Start Time</th>\n            <th>End Time</th>\n          </tr>\n          </thead>\n          <tbody>";o.forEach((t=>{let e=t.start.dateTime||t.start.date,n=t.end.dateTime||t.end.date;d+=`<tr>\n                <td style="padding:4px;">${t.summary||"(No title)"}</td>\n                <td style="padding:4px;">${new Date(e).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})}</td>\n                <td style="padding:4px;">${new Date(n).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})}</td>\n            </tr>`})),d+="</tbody></table>",document.getElementById("event-table").innerHTML=d}document.addEventListener("DOMContentLoaded",(()=>{document.getElementById("authorize_button").style.visibility="hidden",document.getElementById("signout_button").style.visibility="hidden"})),window.handleAuthClick=function(){t.callback=async t=>{if(void 0!==t.error)throw t;document.getElementById("signout_button").style.visibility="visible",document.getElementById("authorize_button").innerText="Refresh",await d()},null===gapi.client.getToken()?t.requestAccessToken({prompt:"consent"}):t.requestAccessToken({prompt:""})},window.handleSignoutClick=function(){const t=gapi.client.getToken();null!==t&&(google.accounts.oauth2.revoke(t.access_token),gapi.client.setToken(""),document.getElementById("event-table").innerText="",document.getElementById("authorize_button").innerText="Authorize",document.getElementById("signout_button").style.visibility="hidden")},window.listUpcomingEvents=d,window._gapiLoaded=function(){gapi.load("client",i)},window._gisLoaded=function(){t=google.accounts.oauth2.initTokenClient({client_id:"88942946394-7a0efu7ror7lhhoqjft9bod098r33eu0.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/calendar.readonly",callback:""}),n=!0,o(),t.callback=async t=>{void 0===t.error&&(document.getElementById("signout_button").style.visibility="visible",document.getElementById("authorize_button").innerText="Refresh",await d())},t.requestAccessToken({prompt:""})},document.addEventListener("DOMContentLoaded",(function(){const t=document.createElement("script");t.src="https://apis.google.com/js/api.js",t.onload=()=>window.gapiLoaded(),document.head.appendChild(t);const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.onload=()=>window.gisLoaded(),document.head.appendChild(e)}))})();