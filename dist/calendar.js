(()=>{let e,t=!1,n=!1;async function o(){await gapi.client.init({apiKey:"AIzaSyA9_NUnPURqgh8GtAoox3bD9Xim6qUlO9k",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"]}),t=!0,i()}function i(){t&&n&&(document.getElementById("authorize_button").style.visibility="visible")}async function d(){let e;const t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),o=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1);try{const t={calendarId:"primary",showDeleted:!1,singleEvents:!0,maxResults:10,orderBy:"startTime",timeMin:n.toISOString(),timeMax:o.toISOString()};e=await gapi.client.calendar.events.list(t)}catch(e){return void(document.getElementById("event-table").innerText=e.message)}const i=e.result.items;if(!i||0==i.length)return void(document.getElementById("event-table").innerText="No events today.");let d="<table>\n        <thead>\n          <tr>\n            <th>Event</th>\n            <th>Start Time</th>\n            <th>End Time</th>\n          </tr>\n          </thead>\n          <tbody>";i.forEach((e=>{let t=e.start.dateTime||e.start.date,n=e.end.dateTime||e.end.date;d+=`<tr>\n                <td style="padding:4px;">${e.summary||"(No title)"}</td>\n                <td style="padding:4px;">${t.replace("T"," ").replace(/:00(\.\d+)?Z?$/,"")}</td>\n                <td style="padding:4px;">${n.replace("T"," ").replace(/:00(\.\d+)?Z?$/,"")}</td>\n            </tr>`})),d+="</tbody></table>",document.getElementById("event-table").innerHTML=d}document.addEventListener("DOMContentLoaded",(()=>{document.getElementById("authorize_button").style.visibility="hidden",document.getElementById("signout_button").style.visibility="hidden"})),window.handleAuthClick=function(){e.callback=async e=>{if(void 0!==e.error)throw e;document.getElementById("signout_button").style.visibility="visible",document.getElementById("authorize_button").innerText="Refresh",await d()},null===gapi.client.getToken()?e.requestAccessToken({prompt:"consent"}):e.requestAccessToken({prompt:""})},window.handleSignoutClick=function(){const e=gapi.client.getToken();null!==e&&(google.accounts.oauth2.revoke(e.access_token),gapi.client.setToken(""),document.getElementById("event-table").innerText="",document.getElementById("authorize_button").innerText="Authorize",document.getElementById("signout_button").style.visibility="hidden")},window.listUpcomingEvents=d,window._gapiLoaded=function(){gapi.load("client",o)},window._gisLoaded=function(){e=google.accounts.oauth2.initTokenClient({client_id:"88942946394-7a0efu7ror7lhhoqjft9bod098r33eu0.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/calendar.readonly",callback:""}),n=!0,i(),e.callback=async e=>{void 0===e.error&&(document.getElementById("signout_button").style.visibility="visible",document.getElementById("authorize_button").innerText="Refresh",await d())},e.requestAccessToken({prompt:""})},document.addEventListener("DOMContentLoaded",(function(){const e=document.createElement("script");e.src="https://apis.google.com/js/api.js",e.onload=()=>window.gapiLoaded(),document.head.appendChild(e);const t=document.createElement("script");t.src="https://accounts.google.com/gsi/client",t.onload=()=>window.gisLoaded(),document.head.appendChild(t)}))})();